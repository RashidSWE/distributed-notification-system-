<mxfile host="app.diagrams.net" modified="2025-11-12T11:55:00.000Z" agent="5.0 (Windows NT 10.0; Win64; x64)" etag="A_k7l1m2n3o4p5q6r7s8t9u0v1w2x3y4z5" version="23.0.4">
  <diagram id="notification_architecture_v4" name="Notification System Final">
    <mxGraphModel dx="1290" dy="782" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="850" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <mxCell id="2" value="&lt;b&gt;API Gateway&lt;/b&gt;&lt;br&gt;• Auth &amp; Validate Requests&lt;br&gt;• Calls User Service&lt;br&gt;• Enqueues to RabbitMQ (Email/Push)&lt;br&gt;• &lt;b&gt;Consumes status.queue&lt;/b&gt;" style="shape=cylinder;whiteSpace=wrap;html=1;boundedbox=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="380" y="50" width="200" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="3" value="&lt;b&gt;User Service&lt;/b&gt;&lt;br&gt;• Manages contact &amp; prefs&lt;br&gt;• Saves to User DB" style="shape=process;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="100" y="250" width="180" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="4" value="&lt;b&gt;Template Service&lt;/b&gt;&lt;br&gt;• Stores templates&lt;br&gt;• Exposes &lt;b&gt;REST&lt;/b&gt; GET /templates/{code}&lt;br&gt;• Saves to Template DB" style="shape=process;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="390" y="250" width="180" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="14" value="Status DB" style="shape=cylinder;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="420" y="150" width="120" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="7" value="&lt;b&gt;RabbitMQ Exchange&lt;/b&gt;&lt;br&gt;notifications.direct" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="690" y="250" width="180" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="8" value="email.queue" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" vertex="1" parent="1">
          <mxGeometry x="690" y="330" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9" value="push.queue" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" vertex="1" parent="1">
          <mxGeometry x="780" y="330" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="10" value="&lt;b&gt;status.queue&lt;/b&gt;" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" vertex="1" parent="1">
          <mxGeometry x="780" y="490" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="11" value="failed.queue" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;" vertex="1" parent="1">
          <mxGeometry x="690" y="490" width="90" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="5" value="&lt;b&gt;Email Service&lt;/b&gt;&lt;br&gt;• Consumes email.queue&lt;br&gt;• Calls Template Service&lt;br&gt;• Sends emails&lt;br&gt;• Publishes delivery status" style="shape=process;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="100" y="550" width="200" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="6" value="&lt;b&gt;Push Service&lt;/b&gt;&lt;br&gt;• Consumes push.queue&lt;br&gt;• Calls Template Service&lt;br&gt;• Sends notifications&lt;br&gt;• Publishes delivery status" style="shape=process;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="670" y="550" width="200" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="12" value="User DB" style="shape=cylinder;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="130" y="340" width="120" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="13" value="Template DB" style="shape=cylinder;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="420" y="340" width="120" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="17" value="Saves Status" style="endArrow=none;html=1;edgeStyle=orthogonalEdge;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="2" target="14" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="480" y="140" as="sourcePoint" />
            <mxPoint x="480" y="150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="18" value="REST/gRPC Call (Auth/Prefs)" style="endArrow=block;html=1;dashed=1;edgeStyle=orthogonalEdge;" parent="1" source="2" target="3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="95" as="sourcePoint" />
            <mxPoint x="280" y="285" as="targetPoint" />
            <Array as="points">
              <mxPoint x="340" y="95" />
              <mxPoint x="340" y="285" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="19" value="Publishes Notification Event" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;" parent="1" source="2" target="7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="95" as="sourcePoint" />
            <mxPoint x="690" y="285" as="targetPoint" />
            <Array as="points">
              <mxPoint x="630" y="95" />
              <mxPoint x="630" y="285" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="20" value="Consumes email.queue" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;" parent="1" source="8" target="5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="735" y="350" as="sourcePoint" />
            <mxPoint x="200" y="550" as="targetPoint" />
            <Array as="points">
              <mxPoint x="735" y="470" />
              <mxPoint x="200" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="21" value="Consumes push.queue" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;" parent="1" source="9" target="6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="825" y="350" as="sourcePoint" />
            <mxPoint x="770" y="550" as="targetPoint" />
            <Array as="points">
              <mxPoint x="825" y="470" />
              <mxPoint x="770" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="22" value="REST/gRPC Call (Get Template)" style="endArrow=block;html=1;dashed=1;edgeStyle=orthogonalEdge;" parent="1" source="5" target="4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="300" y="595" as="sourcePoint" />
            <mxPoint x="390" y="285" as="targetPoint" />
            <Array as="points">
              <mxPoint x="350" y="595" />
              <mxPoint x="350" y="285" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="23" value="REST/gRPC Call (Get Template)" style="endArrow=block;html=1;dashed=1;edgeStyle=orthogonalEdge;" parent="1" source="6" target="4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="670" y="595" as="sourcePoint" />
            <mxPoint x="570" y="285" as="targetPoint" />
            <Array as="points">
              <mxPoint x="630" y="595" />
              <mxPoint x="630" y="285" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="24" value="Publishes Status" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;entryX=0.5;entryY=1;" parent="1" source="5" target="10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="300" y="605" as="sourcePoint" />
            <mxPoint x="825" y="490" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="700" />
              <mxPoint x="825" y="700" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="25" value="Publishes Status" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;exitX=0.5;exitY=1;" parent="1" source="6" target="10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="770" y="640" as="sourcePoint" />
            <mxPoint x="825" y="490" as="targetPoint" />
            <Array as="points">
              <mxPoint x="770" y="680" />
              <mxPoint x="825" y="680" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="26" value="Consumes Status" style="endArrow=block;html=1;edgeStyle=orthogonalEdge;exitX=0.5;exitY=0;entryX=0.5;entryY=1;" parent="1" source="10" target="2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="825" y="490" as="sourcePoint" />
            <mxPoint x="480" y="140" as="targetPoint" />
            <Array as="points">
              <mxPoint x="825" y="450" />
              <mxPoint x="480" y="450" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="27" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdge;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="3" target="12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="190" y="320" as="sourcePoint" />
            <mxPoint x="190" y="340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="28" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdge;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="4" target="13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="480" y="320" as="sourcePoint" />
            <mxPoint x="480" y="340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>